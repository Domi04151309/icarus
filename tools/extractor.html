<h1>Data Extractor</h1>
<p id="result"></p>
<script>
  const COLUMN_MAIN_TITLE = 0
  const COLUMN_VARIATION_TITLE = 1
  const COLUMN_FAT_LOSS = 2
  const COLUMN_MUSCLE_GAIN = 7
  const COLUMN_CARDIO = 8
  const COLUMN_ENDURANCE= 9
  const COLUMN_ARMS = 10
  const COLUMN_SHOULDERS = 11
  const COLUMN_BACK = 12
  const COLUMN_CHEST = 13
  const COLUMN_ABS = 14
  const COLUMN_BOOTY = 15
  const COLUMN_LEGS = 16

  const FILE_PATH = './Data%20-%20Exercises.csv'
  const IGNORE_LINES = [1, 2, 34, 45, 58]

  function getIntFromArray(array, index) {
    var temp = parseInt(array[index], 10)
    if (isNaN(temp)) return 0
    else return temp
  }

  fetch(FILE_PATH)
    .then(response => response.text())
    .then(result => {
      var lines = result.split('\n')

      var removedLines = 0
      IGNORE_LINES.forEach(item => {
        lines.splice(item - removedLines - 1 , 1)
        removedLines++
      })

      var usefulData = []
      var generalType = null
      var lineArray = []
      var currentObj = null
      var variations = []

      lines.forEach(item => {
        lineArray = item.split(',')
        if (lineArray[COLUMN_MAIN_TITLE] != '') {
          if (currentObj != null) {
            currentObj.variations = variations
            usefulData.push(currentObj)
          }
          generalType = lineArray[COLUMN_MAIN_TITLE]
          currentObj = {}
          variations = []
          currentObj.title = generalType
        }
        variations.push({
          title: lineArray[COLUMN_VARIATION_TITLE],
          fatLoss: getIntFromArray(lineArray, COLUMN_FAT_LOSS),
          muscleGain: getIntFromArray(lineArray, COLUMN_MUSCLE_GAIN),
          cardio: getIntFromArray(lineArray, COLUMN_CARDIO),
          endurance: getIntFromArray(lineArray, COLUMN_ENDURANCE),
          arms: getIntFromArray(lineArray, COLUMN_ARMS),
          shoulders: getIntFromArray(lineArray, COLUMN_SHOULDERS),
          back: getIntFromArray(lineArray, COLUMN_BACK),
          chest: getIntFromArray(lineArray, COLUMN_CHEST),
          abs: getIntFromArray(lineArray, COLUMN_ABS),
          booty: getIntFromArray(lineArray, COLUMN_BOOTY),
          legs: getIntFromArray(lineArray, COLUMN_LEGS)
        })
      })
      console.log(usefulData)
      document.getElementById('result').innerHTML = JSON.stringify(usefulData)
    })
</script>
